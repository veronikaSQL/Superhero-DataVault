CREATE OR REPLACE VIEW DATA_VAULT.SAT_BEING_KAGGLE_NLP
AS

WITH CTE_READ_FROM_RAW AS (
  SELECT
    SAT_BEING_KAGGLE_NLP_KEY
    , HUB_BEING_KEY
    , URL
    , SOURCE_URL
     , NAME
    , REAL_NAME
    , FULL_NAME
    , OVERALL_SCORE
    , HISTORY_TEXT
    , POWERS_TEXT
    , INTELLIGENCE_SCORE
    , STRENGTH_SCORE
    , SPEED_SCORE
    , DURABILITY_SCORE
    , POWER_SCORE
    , COMBAT_SCORE
    , SUPERPOWERS
    , ALTER_EGOS
    , ALIASES
    , PLACE_OF_BIRTH
    , FIRST_APPEARANCE
    , CREATOR
    , ALIGNMENT
    , OCCUPATION
    , BASE
    , TEAMS
    , RELATIVES
    , GENDER
    , TYPE_RACE
    , HEIGHT
    , WEIGHT
    , EYE_COLOR
    , HAIR_COLOR
    , SKIN_COLOR
    , IMG
    , HAS_ELECTROKINESIS
    , HAS_ENERGY_CONSTRUCTS
    , HAS_MIND_CONTROL_RESISTANCE
    , HAS_MATTER_MANIPULATION
    , HAS_TELEPATHY_RESISTANCE
    , HAS_MIND_CONTROL
    , HAS_ENHANCED_HEARING
    , HAS_DIMENSIONAL_TRAVEL
    , HAS_ELEMENT_CONTROL
    , HAS_SIZE_CHANGING
    , HAS_FIRE_RESISTANCE
    , HAS_FIRE_CONTROL
    , HAS_DEXTERITY
    , HAS_REALITY_WARPING
    , HAS_ILLUSIONS
    , HAS_ENERGY_BEAMS
    , HAS_PEAK_HUMAN_CONDITION
    , HAS_SHAPESHIFTING
    , HAS_HEAT_RESISTANCE
    , HAS_JUMP
    , HAS_SELF_SUSTENANCE
    , HAS_ENERGY_ABSORPTION
    , HAS_COLD_RESISTANCE
    , HAS_MAGIC
    , HAS_TELEKINESIS
    , HAS_TOXIN_AND_DISEASE_RESISTANCE
    , HAS_TELEPATHY
    , HAS_REGENERATION
    , HAS_IMMORTALITY
    , HAS_TELEPORTATION
    , HAS_FORCE_FIELDS
    , HAS_ENERGY_MANIPULATION
    , HAS_ENDURANCE
    , HAS_LONGEVITY
    , HAS_WEAPON_BASED_POWERS
    , HAS_ENERGY_BLASTS
    , HAS_ENHANCED_SENSES
    , HAS_INVULNERABILITY
    , HAS_STEALTH
    , HAS_MARKSMANSHIP
    , HAS_FLIGHT
    , HAS_ACCELERATED_HEALING
    , HAS_WEAPONS_MASTER
    , HAS_INTELLIGENCE
    , HAS_REFLEXES
    , HAS_SUPER_SPEED
    , HAS_DURABILITY
    , HAS_STAMINA
    , HAS_AGILITY
    , HAS_SUPER_STRENGTH
    , RECORD_HASH
    , LOAD_TIME
    , LOAD_TIME as EFFECTIVE_FROM_DT
    , lead(LOAD_TIME) over (partition by HUB_BEING_KEY order by LOAD_TIME) as EFFECTIVE_TO_DT  
FROM DATA_VAULT.SAT_BEING_KAGGLE_NLP_RAW
)
SELECT 
      SAT_BEING_KAGGLE_NLP_KEY
    , HUB_BEING_KEY
    , URL
    , SOURCE_URL
     , NAME
    , REAL_NAME
    , FULL_NAME
    , OVERALL_SCORE
    , HISTORY_TEXT
    , POWERS_TEXT
    , INTELLIGENCE_SCORE
    , STRENGTH_SCORE
    , SPEED_SCORE
    , DURABILITY_SCORE
    , POWER_SCORE
    , COMBAT_SCORE
    , SUPERPOWERS
    , ALTER_EGOS
    , ALIASES
    , PLACE_OF_BIRTH
    , FIRST_APPEARANCE
    , CREATOR
    , ALIGNMENT
    , OCCUPATION
    , BASE
    , TEAMS
    , RELATIVES
    , GENDER
    , TYPE_RACE
    , HEIGHT
    , WEIGHT
    , EYE_COLOR
    , HAIR_COLOR
    , SKIN_COLOR
    , IMG
    , HAS_ELECTROKINESIS
    , HAS_ENERGY_CONSTRUCTS
    , HAS_MIND_CONTROL_RESISTANCE
    , HAS_MATTER_MANIPULATION
    , HAS_TELEPATHY_RESISTANCE
    , HAS_MIND_CONTROL
    , HAS_ENHANCED_HEARING
    , HAS_DIMENSIONAL_TRAVEL
    , HAS_ELEMENT_CONTROL
    , HAS_SIZE_CHANGING
    , HAS_FIRE_RESISTANCE
    , HAS_FIRE_CONTROL
    , HAS_DEXTERITY
    , HAS_REALITY_WARPING
    , HAS_ILLUSIONS
    , HAS_ENERGY_BEAMS
    , HAS_PEAK_HUMAN_CONDITION
    , HAS_SHAPESHIFTING
    , HAS_HEAT_RESISTANCE
    , HAS_JUMP
    , HAS_SELF_SUSTENANCE
    , HAS_ENERGY_ABSORPTION
    , HAS_COLD_RESISTANCE
    , HAS_MAGIC
    , HAS_TELEKINESIS
    , HAS_TOXIN_AND_DISEASE_RESISTANCE
    , HAS_TELEPATHY
    , HAS_REGENERATION
    , HAS_IMMORTALITY
    , HAS_TELEPORTATION
    , HAS_FORCE_FIELDS
    , HAS_ENERGY_MANIPULATION
    , HAS_ENDURANCE
    , HAS_LONGEVITY
    , HAS_WEAPON_BASED_POWERS
    , HAS_ENERGY_BLASTS
    , HAS_ENHANCED_SENSES
    , HAS_INVULNERABILITY
    , HAS_STEALTH
    , HAS_MARKSMANSHIP
    , HAS_FLIGHT
    , HAS_ACCELERATED_HEALING
    , HAS_WEAPONS_MASTER
    , HAS_INTELLIGENCE
    , HAS_REFLEXES
    , HAS_SUPER_SPEED
    , HAS_DURABILITY
    , HAS_STAMINA
    , HAS_AGILITY
    , HAS_SUPER_STRENGTH
    , LOAD_TIME
    , EFFECTIVE_FROM_DT
    , ifnull(EFFECTIVE_TO_DT, '2099-12-31'::timestamp_tz)  as EFFECTIVE_TO_DT
    , (EFFECTIVE_TO_DT is null) as IS_CURRENT  
    , RECORD_HASH 
     FROM CTE_READ_FROM_RAW; 
